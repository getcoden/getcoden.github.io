<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/header.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/header.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/header.png">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"getcoden.github.io","root":"/","images":"/images","scheme":"Pisces","version":"8.2.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta property="og:type" content="website">
<meta property="og:title" content="Bitcoder">
<meta property="og:url" content="https://getcoden.github.io/page/2/index.html">
<meta property="og:site_name" content="Bitcoder">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Bitcode">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://getcoden.github.io/page/2/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<title>Bitcoder</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Bitcoder</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">getsomecodes</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bitcode"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Bitcode</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">102</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/getcoden" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;getcoden" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:z337885169@gmail.com" title="E-Mail → mailto:z337885169@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://google.com/" title="Google → https:&#x2F;&#x2F;google.com" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>Google</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://youtube.com/" title="YouTube → https:&#x2F;&#x2F;youtube.com" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/08/22/%E8%8E%B7%E5%8F%96%E8%B7%AF%E5%BE%84%E4%B8%8B%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E5%85%A8%E5%90%8D%E8%B7%AF%E5%BE%84%E5%88%A4%E6%96%AD%E6%98%AF%E8%B7%AF%E5%BE%84%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/08/22/%E8%8E%B7%E5%8F%96%E8%B7%AF%E5%BE%84%E4%B8%8B%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E5%85%A8%E5%90%8D%E8%B7%AF%E5%BE%84%E5%88%A4%E6%96%AD%E6%98%AF%E8%B7%AF%E5%BE%84%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8/" class="post-title-link" itemprop="url">获取路径下所有文件全名路径判断是路径目录文件是否存在</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-08-21 17:53:13 / 修改时间：09:54:23" itemprop="dateCreated datePublished" datetime="2021-08-21T17:53:13Z">2021-08-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file_name</span>(<span class="params">file_dir</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(file_dir):</span><br><span class="line">        <span class="comment"># print(root)  # 当前目录路径</span></span><br><span class="line">        print(dirs)  <span class="comment"># 当前路径下所有子目录</span></span><br><span class="line">        print(files)  <span class="comment"># 当前路径下所有非目录子文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file_name(<span class="string">r&quot;C:\Users\win\Desktop\ccc&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file_name</span>(<span class="params">file_dir</span>):</span></span><br><span class="line">    L = []</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(file_dir):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> os.path.splitext(file)[<span class="number">1</span>] == <span class="string">&#x27;.png&#x27;</span>:  <span class="comment"># 想要保存的文件格式</span></span><br><span class="line">                L.append(os.path.join(root, file))</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line">file_name(<span class="string">r&quot;C:\Users\win\Desktop\ccc&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#其中os.path.splitext()函数将路径拆分为文件名+扩展名</span></span><br></pre></td></tr></table></figure>



<pre><code>[&#39;C:\\Users\\win\\Desktop\\ccc\\20200706130733539 - 副本 (2).png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\20200706130733539 - 副本.png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\20200706130733539.png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\modify\\20200706130733539 - 副本 (2).png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\modify\\20200706130733539 - 副本.png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\modify\\20200706130733539.png&#39;]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">dirpath = <span class="string">r&#x27;D:\Premiere\1&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(dirpath):</span><br><span class="line">	os.mksdir(dirpath)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历指定目录，显示目录下的目录和文件名（分开显示）</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printPath</span>(<span class="params">path</span>):</span></span><br><span class="line">    dirList = []</span><br><span class="line">    fileList = []</span><br><span class="line"></span><br><span class="line">    dirFiles = os.listdir(path)</span><br><span class="line">    <span class="keyword">for</span> dirFile <span class="keyword">in</span> dirFiles:</span><br><span class="line">        curPath = path + <span class="string">&#x27;/&#x27;</span> + dirFile</span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(curPath):</span><br><span class="line">            <span class="comment"># 排除隐藏文件</span></span><br><span class="line">            <span class="keyword">if</span> dirFile[<span class="number">0</span>] != <span class="string">&#x27;.&#x27;</span>:</span><br><span class="line">                dirList.append(curPath)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> os.path.isfile(curPath):</span><br><span class="line">            <span class="keyword">if</span> dirFile[<span class="number">0</span>] != <span class="string">&#x27;.&#x27;</span>:</span><br><span class="line">                fileList.append(curPath)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;dirlist里有啥？&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> dir_ <span class="keyword">in</span> dirList:</span><br><span class="line">        print(<span class="string">&#x27;t&#x27;</span>, dir_)</span><br><span class="line">    print(<span class="string">&#x27;filelist里有啥？&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> file_ <span class="keyword">in</span> fileList:</span><br><span class="line">        print(<span class="string">&#x27;t&#x27;</span>, file_)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">path = <span class="string">r&quot;C:\Users\win\Desktop\ccc&quot;</span></span><br><span class="line">printPath(path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历指定目录，显示目录下的文件名</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">eachFile</span>(<span class="params">filepath</span>):</span></span><br><span class="line">    pathDir = os.listdir(filepath)</span><br><span class="line">    print(<span class="string">&#x27;pathDir:&#x27;</span>, pathDir)</span><br><span class="line">    <span class="keyword">for</span> allDir <span class="keyword">in</span> pathDir:</span><br><span class="line">        child = os.path.join(filepath, allDir)</span><br><span class="line">        print(child)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">eachFile(<span class="string">r&quot;C:\Users\win\Desktop\ccc&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 递归获取路径下所有文件名</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">listdir</span>(<span class="params">path, list_name</span>):</span>  <span class="comment"># 传入存储的list</span></span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(path):</span><br><span class="line">        file_path = os.path.join(path, file)</span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(file_path):</span><br><span class="line">        	listdir(file_path, list_name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            list_name.append(file_path)</span><br><span class="line">    <span class="keyword">return</span> list_name</span><br><span class="line">listdir(<span class="string">r&quot;C:\Users\win\Desktop\ccc&quot;</span>,list_name=[])</span><br></pre></td></tr></table></figure>



<pre><code>[&#39;C:\\Users\\win\\Desktop\\ccc\\20200706130733539 - 副本 (2).png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\20200706130733539 - 副本.png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\20200706130733539.png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\modify\\20200706130733539 - 副本 (2).png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\modify\\20200706130733539 - 副本.png&#39;,
 &#39;C:\\Users\\win\\Desktop\\ccc\\modify\\20200706130733539.png&#39;]
</code></pre>
<h2 id="怎样使用-Python-来判断一个路径是否存在判断一个路径是文件还是目录-判断一个路径是否存在"><a href="#怎样使用-Python-来判断一个路径是否存在判断一个路径是文件还是目录-判断一个路径是否存在" class="headerlink" title="怎样使用 Python 来判断一个路径是否存在判断一个路径是文件还是目录 判断一个路径是否存在"></a>怎样使用 Python 来判断一个路径是否存在判断一个路径是文件还是目录 判断一个路径是否存在</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.path.exists(path)     <span class="comment"># 判断一个路径是否存在，可以判断一个文件或目录（文件夹）是否存在</span></span><br><span class="line"></span><br><span class="line">os.path.isdir(path)      <span class="comment"># 判断一个目录（文件夹）是否存在</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断一个路径是文件还是目录（文件夹）</span></span><br><span class="line"><span class="comment"># 方法一</span></span><br><span class="line"></span><br><span class="line">os.path.isdir(path)   <span class="comment"># 返回 True 表示是目录（文件夹）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法二</span></span><br><span class="line"></span><br><span class="line">os.path.isfile(path)   <span class="comment"># 返回 True 表示是文件</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/08/22/%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%BA%94%E7%94%A8%E5%8E%BB%E9%99%A4%E5%9B%BE%E7%89%87%E6%B0%B4%E5%8D%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/08/22/%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%BA%94%E7%94%A8%E5%8E%BB%E9%99%A4%E5%9B%BE%E7%89%87%E6%B0%B4%E5%8D%B0/" class="post-title-link" itemprop="url">函数的实例应用去除图片水印</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-08-21 17:51:42 / 修改时间：09:52:17" itemprop="dateCreated datePublished" datetime="2021-08-21T17:51:42Z">2021-08-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 PDF 文档 分割成图片</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> fitz</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pyMuPDF_fitz</span>(<span class="params">pdfPath, imagePath</span>):</span></span><br><span class="line">    startTime_pdf2img = datetime.datetime.now()  <span class="comment"># 开始时间</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;imagePath=&quot;</span>+imagePath)</span><br><span class="line">    pdfDoc = fitz.<span class="built_in">open</span>(pdfPath)</span><br><span class="line">    <span class="keyword">for</span> pg <span class="keyword">in</span> <span class="built_in">range</span>(pdfDoc.pageCount):</span><br><span class="line">        page = pdfDoc[pg]</span><br><span class="line">        rotate = <span class="built_in">int</span>(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 每个尺寸的缩放系数为1.3，这将为我们生成分辨率提高2.6的图像。</span></span><br><span class="line">        <span class="comment"># 此处若是不做设置，默认图片大小为：792X612, dpi=72</span></span><br><span class="line">        zoom_x = <span class="number">1.33333333</span>  <span class="comment"># (1.33333333--&gt;1056x816)   (2--&gt;1584x1224)</span></span><br><span class="line">        zoom_y = <span class="number">1.33333333</span></span><br><span class="line">        mat = fitz.Matrix(zoom_x, zoom_y).preRotate(rotate)</span><br><span class="line">        pix = page.getPixmap(matrix=mat, alpha=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(imagePath):  <span class="comment"># 判断存放图片的文件夹是否存在</span></span><br><span class="line">            os.makedirs(imagePath)  <span class="comment"># 若图片文件夹不存在就创建</span></span><br><span class="line"></span><br><span class="line">        pix.writePNG(imagePath+<span class="string">&#x27;/&#x27;</span>+<span class="string">&#x27;images_%s.png&#x27;</span> % pg)  <span class="comment"># 将图片写入指定的文件夹内</span></span><br><span class="line"></span><br><span class="line">    endTime_pdf2img = datetime.datetime.now()  <span class="comment"># 结束时间</span></span><br><span class="line">    print(<span class="string">&#x27;pdf2img时间=&#x27;</span>, (endTime_pdf2img - startTime_pdf2img).seconds)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdfPath = <span class="string">r&quot;D:\教学工具软件\冰点文库下载器 3.2.10 去广告版\冰点文库下载器 3.2.10 去广告版\kpdf\哪些人适合学Python培训，你在其中吗？.pdf&quot;</span></span><br><span class="line">    imagePath = <span class="string">r&quot;D:\1jieya\image&quot;</span></span><br><span class="line">    pyMuPDF_fitz(pdfPath, imagePath)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将图片去除水印，配合上一个程序使用</span></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># img = Image.open(r&quot;D:\1jieya\image\images_0.png&quot;)</span></span><br><span class="line"><span class="comment"># width, height = img.size</span></span><br><span class="line"><span class="comment"># for pos in product(range(width), range(height)):</span></span><br><span class="line"><span class="comment">#     if sum(img.getpixel(pos)[:3]) &gt; 600:</span></span><br><span class="line"><span class="comment">#         img.putpixel(pos, (255, 255, 255))</span></span><br><span class="line"><span class="comment"># img.save(r&quot;C:\Users\win\Desktop\removed_1.png&quot;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = <span class="string">r&quot;D:\1jieya\image&quot;</span></span><br><span class="line">output = <span class="string">r&quot;D:\1jieya\remove&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modify</span>():</span></span><br><span class="line">    <span class="keyword">for</span> image_name <span class="keyword">in</span> os.listdir(<span class="built_in">input</span>):</span><br><span class="line">        print(image_name)</span><br><span class="line">        img = Image.<span class="built_in">open</span>(os.path.join(<span class="built_in">input</span>, image_name))</span><br><span class="line">        width, height = img.size</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> product(<span class="built_in">range</span>(width), <span class="built_in">range</span>(height)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">sum</span>(img.getpixel(pos)[:<span class="number">3</span>]) &gt; <span class="number">600</span>:</span><br><span class="line">                img.putpixel(pos, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">        img.save(os.path.join(output, image_name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    modify()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 批量将图片修改为指定大小</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageFilter, ImageDraw</span><br><span class="line"></span><br><span class="line"><span class="comment"># im = Image.open(r&quot;C:\Users\win\Desktop\ccc\20200706130733539.png&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取图片的格式，大小，以及模式</span></span><br><span class="line"><span class="comment"># print(im.format, im.size, im.mode)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定图片的像素</span></span><br><span class="line"><span class="comment"># im.thumbnail((720, 1280))</span></span><br><span class="line"><span class="comment"># im.save(r&quot;C:\Users\win\Desktop\ccc\128_128.jpg&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 旋转图片的方向</span></span><br><span class="line"><span class="comment"># dest_im = im.rotate(90)</span></span><br><span class="line"><span class="comment"># dest_im.save(r&quot;C:\Users\win\Desktop\ccc\90.png&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给图片添加滤镜</span></span><br><span class="line"><span class="comment"># dest_im = im.filter(ImageFilter.GaussianBlur)</span></span><br><span class="line"><span class="comment"># dest_im.show()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # 图片反转</span></span><br><span class="line"><span class="comment"># dest_im = im.transpose(Image.FLIP_LEFT_RIGHT)</span></span><br><span class="line"><span class="comment"># dest_im = im.transpose(Image.FLIP_TOP_BOTTOM)</span></span><br><span class="line"><span class="comment"># dest_im.show()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图片上写文字</span></span><br><span class="line"><span class="comment"># image = Image.open(r&quot;C:\Users\win\Desktop\ccc\20200706130733539.png&quot;)</span></span><br><span class="line"><span class="comment"># img_draw = ImageDraw.Draw(image)</span></span><br><span class="line"><span class="comment"># img_draw.text((1270, 1250), &#x27;hello world!&#x27;, fill=&#x27;green&#x27;)</span></span><br><span class="line"><span class="comment"># image.show()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量将图片的大小设置为指定大小</span></span><br><span class="line"></span><br><span class="line">in_path = <span class="string">r&quot;C:\Users\win\Desktop\ccc&quot;</span></span><br><span class="line">out_path = os.path.join(in_path, <span class="string">&#x27;modify&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(out_path):</span><br><span class="line">    os.makedirs(out_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modify</span>():</span></span><br><span class="line">    <span class="keyword">for</span> image_name <span class="keyword">in</span> os.listdir(in_path):</span><br><span class="line">        cur_dir = in_path + <span class="string">&#x27;/&#x27;</span> + image_name</span><br><span class="line">        <span class="keyword">if</span> os.path.isfile(cur_dir):</span><br><span class="line">            print(<span class="string">f&#x27;正在处理:<span class="subst">&#123;cur_dir&#125;</span>&#x27;</span>)</span><br><span class="line">            im = Image.<span class="built_in">open</span>(cur_dir)</span><br><span class="line">            im.thumbnail((<span class="number">1280</span>, <span class="number">720</span>))</span><br><span class="line">            im.save(os.path.join(out_path, image_name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    modify()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/08/22/%E8%AF%BB%E5%8F%96%E5%A4%9A%E8%A1%8C%E4%B8%BA%E8%A1%A8%E5%A4%B4%E7%9A%84%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/08/22/%E8%AF%BB%E5%8F%96%E5%A4%9A%E8%A1%8C%E4%B8%BA%E8%A1%A8%E5%A4%B4%E7%9A%84%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">读取多行为表头的方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-08-21 17:47:53 / 修改时间：09:51:21" itemprop="dateCreated datePublished" datetime="2021-08-21T17:47:53Z">2021-08-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br></pre></td></tr></table></figure>
<h2 id="对于待合并的数据表格的表头不正规的情况，如表头由多行组成且行中有折分单元格的情况，这种情形下，如何强行合并可能得不到想要的效果，如何做，且看如下分解："><a href="#对于待合并的数据表格的表头不正规的情况，如表头由多行组成且行中有折分单元格的情况，这种情形下，如何强行合并可能得不到想要的效果，如何做，且看如下分解：" class="headerlink" title="对于待合并的数据表格的表头不正规的情况，如表头由多行组成且行中有折分单元格的情况，这种情形下，如何强行合并可能得不到想要的效果，如何做，且看如下分解："></a>对于待合并的数据表格的表头不正规的情况，如表头由多行组成且行中有折分单元格的情况，这种情形下，如何强行合并可能得不到想要的效果，如何做，且看如下分解：</h2><h3 id="第一步：先进行常规合并操作，得到不规整的合并后的的表，目得到的是内容齐全的在一个表格内的所有数据"><a href="#第一步：先进行常规合并操作，得到不规整的合并后的的表，目得到的是内容齐全的在一个表格内的所有数据" class="headerlink" title="第一步：先进行常规合并操作，得到不规整的合并后的的表，目得到的是内容齐全的在一个表格内的所有数据"></a>第一步：先进行常规合并操作，得到不规整的合并后的的表，目得到的是内容齐全的在一个表格内的所有数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">displaydir</span>(<span class="params">dir_path</span>):</span></span><br><span class="line">    file_list = []</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> filenames <span class="keyword">in</span> os.walk(dir_path):</span><br><span class="line">        <span class="keyword">for</span> table <span class="keyword">in</span> filenames[<span class="number">2</span>]:</span><br><span class="line">            path = filenames[<span class="number">0</span>] + <span class="string">&#x27;/&#x27;</span> + table</span><br><span class="line">            li = pd.read_excel(path,header=<span class="number">3</span>,dtype=<span class="built_in">str</span>)</span><br><span class="line">            li[<span class="string">&#x27;file_name&#x27;</span>] = os.path.splitext(table)[<span class="number">0</span>]</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            file_list.append(li)</span><br><span class="line">            print(<span class="string">&#x27; 第&#x27;</span> + <span class="built_in">str</span>(n) + <span class="string">&#x27; 个表格已合并&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;在该目录下有 %d 个 xlsx 文件&#x27;</span> % <span class="built_in">len</span>(file_list))</span><br><span class="line">    data_result = pd.concat(file_list, ignore_index=<span class="literal">True</span>)</span><br><span class="line">    data_result.to_excel(out_path + <span class="string">&#x27;/&#x27;</span> + <span class="string">&#x27;result.xlsx&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    dir_path = <span class="string">r&quot;D:\1 - 副本\新建文件夹&quot;</span></span><br><span class="line">    out_path = <span class="string">r&quot;C:\Users\win\Desktop\xlsx&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(out_path):</span><br><span class="line">        os.makedirs(out_path)</span><br><span class="line"></span><br><span class="line">    displaydir(dir_path)</span><br></pre></td></tr></table></figure>
<h3 id="第二步：根据需要，对表头的列进行重命名操作，并且删除数据行为全空数据的行。"><a href="#第二步：根据需要，对表头的列进行重命名操作，并且删除数据行为全空数据的行。" class="headerlink" title="第二步：根据需要，对表头的列进行重命名操作，并且删除数据行为全空数据的行。"></a>第二步：根据需要，对表头的列进行重命名操作，并且删除数据行为全空数据的行。</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_excel(<span class="string">r&quot;C:\Users\win\Desktop\xlsx\result.xlsx&quot;</span>,dtype=<span class="built_in">str</span>)</span><br><span class="line">data.rename(columns=&#123;<span class="string">&#x27;Unnamed: 1&#x27;</span>:<span class="string">&#x27;学校&#x27;</span>,<span class="string">&#x27;Unnamed: 2&#x27;</span>:<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;Unnamed: 3&#x27;</span>:<span class="string">&#x27;学生/教师&#x27;</span>,<span class="string">&#x27;Unnamed: 4&#x27;</span>:<span class="string">&#x27;性别&#x27;</span>,<span class="string">&#x27;Unnamed: 5&#x27;</span>:<span class="string">&#x27;身份证号&#x27;</span>,<span class="string">&#x27;Unnamed: 6&#x27;</span>:<span class="string">&#x27;手机号&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line">data.dropna(axis=<span class="number">0</span>,how=<span class="string">&#x27;all&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>





<h2 id="reset-index-重置索引列"><a href="#reset-index-重置索引列" class="headerlink" title="reset_index () 重置索引列"></a>reset_index () 重置索引列</h2><p>pandas 中的 reset_index ()</p>
<p>数据清洗时，会将带空值的行删除，此时 DataFrame 或 Series 类型的数据不再是连续的索引，可以使用 reset_index () 重置索引</p>
<p>eg:<br>import pandas as pd</p>
<p>import numpy as np</p>
<p>df = pd.DataFrame(np.arange(20).reshape(5,4),index=[1,3,4,6,8])</p>
<p>print(df)</p>
<p>reset_index () 重置索引：</p>
<p>print(df.reset_index())</p>
<p>在获得新的 index，原来的 index 变成数据列，保留下来。</p>
<p>不想保留原来的 index，使用参数 drop=True，默认 False。</p>
<p>print(df.reset_index(drop=True))</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.reset_index(drop=<span class="literal">True</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_excel(<span class="string">r&#x27;D:\finall.xlsx&#x27;</span>,index=<span class="literal">False</span>)   <span class="comment"># 保存工作表</span></span><br></pre></td></tr></table></figure>
<h1 id="上述为一个处理的完整过程"><a href="#上述为一个处理的完整过程" class="headerlink" title="上述为一个处理的完整过程"></a>上述为一个处理的完整过程</h1><h1 id="以下为第一学习操作的过程："><a href="#以下为第一学习操作的过程：" class="headerlink" title="以下为第一学习操作的过程："></a>以下为第一学习操作的过程：</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">file_path=<span class="string">r&quot;D:\1 - 副本\新建文件夹&quot;</span></span><br><span class="line">file_list=os.listdir(file_path)</span><br><span class="line"></span><br><span class="line">data_list=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> file_list:</span><br><span class="line">    full_path=os.path.join(file_path,i)</span><br><span class="line">    data=pd.read_excel(full_path,header=<span class="number">3</span>,dtype=<span class="built_in">str</span>)</span><br><span class="line">    data_list.append(data)</span><br><span class="line">    df_all=pd.concat(data_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># df_all.to_excel(r&#x27;D:\result1.xlsx&#x27;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_all.rename(columns=&#123;<span class="string">&#x27;Unnamed: 0&#x27;</span>:<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;Unnamed: 1&#x27;</span>:<span class="string">&#x27;学校&#x27;</span>,<span class="string">&#x27;Unnamed: 2&#x27;</span>:<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;Unnamed: 3&#x27;</span>:<span class="string">&#x27;学生家长&#x27;</span>,<span class="string">&#x27;Unnamed: 4&#x27;</span>:<span class="string">&#x27;性别&#x27;</span>,<span class="string">&#x27;Unnamed: 5&#x27;</span>:<span class="string">&#x27;身份证号&#x27;</span>,<span class="string">&#x27;Unnamed: 6&#x27;</span>:<span class="string">&#x27;手机号&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># df_all.head(20)</span></span><br><span class="line"><span class="comment"># df_all.drop(columns=[&#x27;id&#x27;], inplace=True)</span></span><br><span class="line">df_all.head(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_all.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;all&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.shape</span><br></pre></td></tr></table></figure>
<pre><code>(39, 15)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.reset_index(drop=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_excel(<span class="string">r&#x27;D:\finall.xlsx&#x27;</span>,index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_all.rename(columns=&#123;<span class="string">&#x27;学生家长&#x27;</span>:<span class="string">&#x27;学生/教师&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_all</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_all.dropna(axis=<span class="number">0</span>,how=<span class="string">&#x27;all&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">df_all</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/08/22/os-startfile%E8%87%AA%E5%8A%A8%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E5%A4%B9%E5%8F%8A%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/08/22/os-startfile%E8%87%AA%E5%8A%A8%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E5%A4%B9%E5%8F%8A%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">os.startfile自动打开文件夹及文件的操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-08-21 17:46:06 / 修改时间：09:46:47" itemprop="dateCreated datePublished" datetime="2021-08-21T17:46:06Z">2021-08-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="python-写入文件自动换行问题的方法"><a href="#python-写入文件自动换行问题的方法" class="headerlink" title="python 写入文件自动换行问题的方法"></a>python 写入文件自动换行问题的方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_result</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    writeresult=<span class="built_in">open</span>(<span class="string">&#x27;C:/Users/win/Desktop/aa.txt&#x27;</span>,<span class="string">&#x27;a+&#x27;</span>)</span><br><span class="line">    str1=writeresult.write(<span class="built_in">str</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    writeresult.close()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    a=<span class="built_in">input</span>(<span class="string">&#x27;enter some strs:&#x27;</span>)</span><br><span class="line">    write_result(a)</span><br></pre></td></tr></table></figure>
<pre><code>enter some strs:12
enter some strs:123
enter some strs:1234
enter some strs:12345
enter some strs:123456
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(os.startfile(r&#x27;D:\11&#x27;))</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">open_files_in_dir</span>(<span class="params">path</span>):</span></span><br><span class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(path):</span><br><span class="line">		filepath = os.path.join(path,file)</span><br><span class="line">		<span class="keyword">if</span> os.path.isdir(filepath):</span><br><span class="line">			open_files_in_dir(filepath)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			os.startfile(filepath)</span><br><span class="line">		</span><br><span class="line">path = <span class="string">r&#x27;D:\11&#x27;</span></span><br><span class="line">open_files_in_dir(<span class="string">r&quot;C:\Users\win\Desktop\ccc&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>python 用什么打开文件_用 python 打开文件夹的三种方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一、利用 explorer.exe</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用 explorer.exe 执行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># start_directory = r&#x27;C:\ 代码 \ 软件包&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os.system(&quot;explorer.exe %s&quot; % start_directory)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 二、用 os.startfile</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># import os</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># start_directory = r&#x27;C:\ 代码 \ 软件包&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os.startfile(start_directory)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 三、利用 subprocess</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用 subprocess</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">startfile</span>(<span class="params">filename</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">        os.startfile(filename)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">        subprocess.Popen([<span class="string">&#x27;xdg-open&#x27;</span>, filename])</span><br><span class="line"></span><br><span class="line">start_directory = <span class="string">&#x27;D:/11/9.jpg&#x27;</span></span><br><span class="line"></span><br><span class="line">startfile(start_directory)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/08/22/%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%A4%9A%E4%B8%AAExcel%E5%90%88%E5%B9%B6%E7%9A%84%E8%8A%B1%E5%BC%8F%E6%93%8D%E4%BD%9C%E8%A6%81%E6%B1%82/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/08/22/%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%A4%9A%E4%B8%AAExcel%E5%90%88%E5%B9%B6%E7%9A%84%E8%8A%B1%E5%BC%8F%E6%93%8D%E4%BD%9C%E8%A6%81%E6%B1%82/" class="post-title-link" itemprop="url">代码实现多个Excel合并的花式操作要求</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-08-21 17:44:31 / 修改时间：09:45:16" itemprop="dateCreated datePublished" datetime="2021-08-21T17:44:31Z">2021-08-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一、合并指定目录下的所有订单表</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">files = Path(<span class="string">&quot;orders/orders1&quot;</span>).glob(<span class="string">&quot;*.xlsx&quot;</span>)</span><br><span class="line">dfs = [pd.read_excel(f) <span class="keyword">for</span> f <span class="keyword">in</span> files]</span><br><span class="line">df = pd.concat(dfs)</span><br><span class="line">df.to_excel(<span class="string">&quot;result2.xlsx&quot;</span>,index = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二、合并指定目录下的指定订单表</span></span><br><span class="line"></span><br><span class="line">dfs = [pd.read_excel(f) <span class="keyword">for</span> f <span class="keyword">in</span> (<span class="string">&#x27;orders/orders1/order1.xlsx&#x27;</span>,<span class="string">&#x27;orders/orders1/order2.xlsx&#x27;</span>)]</span><br><span class="line">df = pd.concat(dfs)</span><br><span class="line">df.to_excel(<span class="string">&quot;result3.xlsx&quot;</span>,index = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 三、合并指定目录指定订单表的指定字段</span></span><br><span class="line"></span><br><span class="line">table1 = pd.read_excel(<span class="string">&quot;orders/orders1/order1.xlsx&quot;</span>)</span><br><span class="line">table2 = pd.read_excel(<span class="string">&#x27;orders/orders1/order2.xlsx&#x27;</span>)</span><br><span class="line">part1 = table1.iloc[:,<span class="number">2</span>]  <span class="comment">#取order1.xlsx第3列的所有行</span></span><br><span class="line">part2 = table2.iloc[:,[<span class="number">8</span>,<span class="number">9</span>]]  <span class="comment">#取order2.xlsx的第9、10列的所有行</span></span><br><span class="line">result4 = pd.concat([part1,part2],axis = <span class="number">1</span> ) <span class="comment">#合并  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以上注意axis=1表示横向合并。打印一下result4，长这样</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 四、合并所有目录下的所有订单表</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">file_list = os.walk(<span class="string">&quot;./&quot;</span>)</span><br><span class="line">result = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> dir_path,dirs,files <span class="keyword">in</span> file_list:</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> files:</span><br><span class="line">        file_path = os.path.join(dir_path,f) <span class="comment">#重构文件路径</span></span><br><span class="line">        print(file_path)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;xlsx&#x27;</span> <span class="keyword">in</span> f:    <span class="comment">#只要xlsx文件</span></span><br><span class="line">            df = pd.read_excel(file_path) <span class="comment">#将Excel转成DataFrame</span></span><br><span class="line">            result.append(df)</span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">df = pd.concat(result) <span class="comment">#多个DataFrame合成一个</span></span><br><span class="line">df.to_excel(<span class="string">&quot;result4.xlsx&quot;</span>,index=<span class="literal">False</span>) <span class="comment">#导入到一个新的Excel中</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_image_filepaths</span>(<span class="params">dataset_dir</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(dataset_dir):</span><br><span class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> files:</span><br><span class="line">            fp = os.path.join(root, name)</span><br><span class="line">            <span class="keyword">if</span> name.endswith(<span class="string">&quot;.jpg&quot;</span>):</span><br><span class="line">                result.append(fp)</span><br><span class="line">    <span class="keyword">return</span> result </span><br><span class="line"></span><br><span class="line">find_image_filepaths(<span class="string">r&quot;C:\Users\win\Desktop\1 - 副本&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 批量读取 excel</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">path=<span class="string">r&quot;C:\Users\win\Desktop\1 - 副本&quot;</span></span><br><span class="line">filename_list = os.listdir(<span class="string">r&quot;C:\Users\win\Desktop\1 - 副本&quot;</span>)</span><br><span class="line">train_data=[]</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> filename_list:</span><br><span class="line">    train_data.append(pd.read_excel(path+<span class="string">&#x27;/&#x27;</span>+item))</span><br><span class="line">train_data=pd.concat(train_data)</span><br><span class="line">train_data</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/08/22/%E5%9C%A8Pandas%E4%B8%AD%E6%9B%B4%E6%94%B9%E5%88%97%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/08/22/%E5%9C%A8Pandas%E4%B8%AD%E6%9B%B4%E6%94%B9%E5%88%97%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">在Pandas中更改列的数据类型方法总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-08-21 17:41:04 / 修改时间：09:43:22" itemprop="dateCreated datePublished" datetime="2021-08-21T17:41:04Z">2021-08-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line">a = [[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;1.2&#x27;</span>, <span class="string">&#x27;4.2&#x27;</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;70&#x27;</span>, <span class="string">&#x27;0.03&#x27;</span>], [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;0&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">df= pd.DataFrame(a)</span><br><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>



<pre><code>0    object
1    object
2    object
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame (a, dtype=<span class="string">&#x27;float&#x27;</span>) <span class="comment">#示例 1</span></span><br><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>



<pre><code>0     object
1    float64
2    float64
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame (data=a, dtype=np.int8) <span class="comment">#示例 2</span></span><br><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>
<pre><code>0    object
1    object
2    object
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面是一个字符串 Seriess 的例子，它的 dtype 为 object：</span></span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;4.7&#x27;</span>, <span class="string">&#x27;pandas&#x27;</span>, <span class="string">&#x27;10&#x27;</span>])</span><br><span class="line">s</span><br></pre></td></tr></table></figure>



<pre><code>0         1
1         2
2       4.7
3    pandas
4        10
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 to_numeric 转为数值。默认情况下，它不能处理字母型的字符串 &#x27;pandas&#x27;：</span></span><br><span class="line"><span class="comment"># 如果遇到无效值，第三个选项就是忽略该操作：</span></span><br><span class="line">pd.to_numeric(s,errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br></pre></td></tr></table></figure>



<pre><code>0     1.0
1     2.0
2     4.7
3     NaN
4    10.0
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.to_numeric(s, errors=<span class="string">&#x27;ignore&#x27;</span>)<span class="comment">#the original Series is returned untouched</span></span><br></pre></td></tr></table></figure>



<pre><code>0         1
1         2
2       4.7
3    pandas
4        10
dtype: object
</code></pre>
<p>对于多列或者整个 DataFrame</p>
<p>如果想要将这个操作应用到多个列，依次处理每一列是非常繁琐的，所以可以使用 DataFrame.apply 处理每一列。</p>
<p>对于某个 DataFrame：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;1.2&#x27;</span>, <span class="string">&#x27;4.2&#x27;</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;70&#x27;</span>, <span class="string">&#x27;0.03&#x27;</span>], [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;0&#x27;</span>]]</span><br><span class="line">df = pd.DataFrame(a, columns=[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col3&#x27;</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1.2</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>70</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>



<pre><code>col1    object
col2    object
col3    object
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col3&#x27;</span>]]=df[[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col3&#x27;</span>]].apply(pd.to_numeric)</span><br><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>



<pre><code>col1     object
col2    float64
col3    float64
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1.2</td>
      <td>4.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>70.0</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x</td>
      <td>5.0</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 但是，可能不知道哪些列可以可靠地转换为数字类型。在这种情况下，设置参数：</span></span><br><span class="line"></span><br><span class="line">df.apply(pd.to_numeric, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后该函数将被应用于整个 DataFrame，可以转换为数字类型的列将被转换，而不能 (例如，它们包含非数字字符串或日期) 的列将被单独保留。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 另外 pd.to_datetime 和 pd.to_timedelta 可将数据转换为日期和时间戳。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1.2</td>
      <td>4.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>70.0</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x</td>
      <td>5.0</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 软转换 —— 类型自动推断</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 版本 0.21.0 引入了 infer_objects () 方法，用于将具有对象数据类型的 DataFrame 的列转换为更具体的类型。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例如，用两列对象类型创建一个 DataFrame，其中一个保存整数，另一个保存整数的字符串：</span></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>], <span class="string">&#x27;b&#x27;</span>: [<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>]&#125;, dtype=<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">df.dtypes</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<pre><code>a    object
b    object
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 然后使用 infer_objects ()，可以将列 &#x27;a&#x27; 的类型更改为 int64：</span></span><br><span class="line"></span><br><span class="line">df =df.infer_objects()</span><br><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>



<pre><code>a     int64
b    object
dtype: object
</code></pre>
<p>astype 强制转换</p>
<p>如果试图强制将两列转换为整数类型，可以使用 df.astype (int)。</p>
<p>示例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = [[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;1.2&#x27;</span>, <span class="string">&#x27;4.2&#x27;</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;70&#x27;</span>, <span class="string">&#x27;0.03&#x27;</span>], [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;0&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">df= pd.DataFrame(a, columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>])</span><br><span class="line"></span><br><span class="line">df</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1.2</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>70</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>



<pre><code>one      object
two      object
three    object
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[[<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>]]=df[[<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>]].astype(<span class="built_in">float</span>)</span><br><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>



<pre><code>one       object
two      float64
three    float64
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/07/08/000%E6%8C%89%E6%9D%A1%E4%BB%B6%E6%89%B9%E9%87%8F%E4%BB%8E%E4%B8%8D%E5%90%8C%E6%96%87%E4%BB%B6%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE%E9%A1%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/07/08/000%E6%8C%89%E6%9D%A1%E4%BB%B6%E6%89%B9%E9%87%8F%E4%BB%8E%E4%B8%8D%E5%90%8C%E6%96%87%E4%BB%B6%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE%E9%A1%B9/" class="post-title-link" itemprop="url">000按条件批量从不同文件中提取数据项</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-07-07 16:50:48 / 修改时间：09:16:26" itemprop="dateCreated datePublished" datetime="2021-07-07T16:50:48Z">2021-07-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_one_excel</span>(<span class="params"><span class="built_in">dir</span></span>):</span></span><br><span class="line">    os.chdir(<span class="string">r&quot;D:\test1&quot;</span>)</span><br><span class="line">    file_list = []</span><br><span class="line">    <span class="keyword">for</span> root_dir, sub_dir, files <span class="keyword">in</span> os.walk(<span class="built_in">dir</span>): <span class="comment"># 第一个为起始路径，第二个为起始路径下的文件夹，第三个是起始路径下的文件。</span></span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> file.endswith(<span class="string">&#x27;.xlsx&#x27;</span>):</span><br><span class="line">                <span class="comment"># 构造绝对路径</span></span><br><span class="line">                file_name = os.path.join(root_dir, file)</span><br><span class="line">                file_list.append(file_name)</span><br><span class="line">    dfs=[]</span><br><span class="line">    dfs2=[]</span><br><span class="line">    <span class="keyword">for</span> file1 <span class="keyword">in</span> file_list:</span><br><span class="line">        data = pd.read_excel(file1)</span><br><span class="line">        dataframe_1 =  data.loc[data[<span class="string">&#x27;部门&#x27;</span>] == <span class="string">&#x27;A&#x27;</span>, [<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;工资&#x27;</span>]]</span><br><span class="line">        dataframe_1[<span class="string">&#x27;文件&#x27;</span>]=file1</span><br><span class="line">        dataframe_2 =  data.loc[data[<span class="string">&#x27;工资&#x27;</span>] &lt; <span class="number">3000</span>, [<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;工资&#x27;</span>]]</span><br><span class="line">        dataframe_2[<span class="string">&#x27;文件&#x27;</span>]=file1</span><br><span class="line">        </span><br><span class="line">        dfs.append(dataframe_1)</span><br><span class="line">        dfs2.append(dataframe_2)</span><br><span class="line">        allexcel=pd.concat(dfs)</span><br><span class="line">        allexcel2=pd.concat(dfs2)</span><br><span class="line">        </span><br><span class="line">    allexcel.to_excel(<span class="string">&#x27;./0123.xlsx&#x27;</span>,index=<span class="literal">False</span>)</span><br><span class="line">    allexcel2.to_excel(<span class="string">&#x27;./01233.xlsx&#x27;</span>,index=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">to_one_excel(<span class="string">r&quot;D:\test1&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_one_excel</span>(<span class="params"><span class="built_in">dir</span></span>):</span></span><br><span class="line">    os.chdir(<span class="string">r&quot;D:\test1&quot;</span>)</span><br><span class="line">    file_list = []</span><br><span class="line">    <span class="keyword">for</span> root_dir, sub_dir, files <span class="keyword">in</span> os.walk(<span class="built_in">dir</span>): <span class="comment"># 第一个为起始路径，第二个为起始路径下的文件夹，第三个是起始路径下的文件。</span></span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> file.endswith(<span class="string">&#x27;.xlsx&#x27;</span>):</span><br><span class="line">                <span class="comment"># 构造绝对路径</span></span><br><span class="line">                file_name = os.path.join(root_dir, file)</span><br><span class="line">                file_list.append(file_name)</span><br><span class="line">    dfs=[]</span><br><span class="line">    dfs2=[]</span><br><span class="line">    <span class="keyword">for</span> file1 <span class="keyword">in</span> file_list:</span><br><span class="line">        data = pd.read_excel(file1)</span><br><span class="line">        dataframe_1 =  data.loc[data[<span class="string">&#x27;部门&#x27;</span>] == <span class="string">&#x27;A&#x27;</span>, [<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;工资&#x27;</span>]]</span><br><span class="line">        dataframe_1[<span class="string">&#x27;文件&#x27;</span>]=file1</span><br><span class="line">        dataframe_2 =  data.loc[data[<span class="string">&#x27;工资&#x27;</span>] &lt; <span class="number">3000</span>, [<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;工资&#x27;</span>]]</span><br><span class="line">        dataframe_2[<span class="string">&#x27;文件&#x27;</span>]=file1</span><br><span class="line">        </span><br><span class="line">        dfs.append(dataframe_1)</span><br><span class="line">        dfs2.append(dataframe_2)</span><br><span class="line">        </span><br><span class="line">        allexcel=pd.concat( dfs)</span><br><span class="line">        allexcel2=pd.concat(dfs2)</span><br><span class="line">        </span><br><span class="line">    allexcel.to_excel(<span class="string">&#x27;./finall部门.xlsx&#x27;</span>,index=<span class="literal">False</span>)</span><br><span class="line">    allexcel2.to_excel(<span class="string">&#x27;./finallname.xlsx&#x27;</span>,index=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">to_one_excel(<span class="string">r&quot;D:\test1&quot;</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/07/08/%E5%88%A4%E6%96%AD%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E6%9C%89%E5%87%A0%E4%B8%AAExcel%E6%96%87%E4%BB%B6%E5%8F%8A%E6%8C%89%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/07/08/%E5%88%A4%E6%96%AD%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E6%9C%89%E5%87%A0%E4%B8%AAExcel%E6%96%87%E4%BB%B6%E5%8F%8A%E6%8C%89%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE/" class="post-title-link" itemprop="url">判断某个文件夹下有几个Excel文件及按条件筛选数据</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-07-07 16:39:45 / 修改时间：09:25:02" itemprop="dateCreated datePublished" datetime="2021-07-07T16:39:45Z">2021-07-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,xlrd</span><br><span class="line"> </span><br><span class="line">data_path = os.path.join(<span class="string">&#x27;D:\jupyter notebook&#x27;</span>,<span class="string">&#x27;test&#x27;</span>)<span class="comment">#os.path.join()函数：连接两个或更多的路径名</span></span><br><span class="line">print(data_path)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#获取目录下所有Excel中sheet</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getTables</span>():</span></span><br><span class="line">    <span class="keyword">for</span> excel <span class="keyword">in</span> os.listdir(data_path):<span class="comment">#os.listdir() 方法用于返回指定的文件夹包含的文件或文件夹的名字的列表</span></span><br><span class="line">        print(excel)</span><br><span class="line">        <span class="keyword">if</span> excel.startswith(<span class="string">&#x27;~&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        excelPath = os.path.join(data_path, excel)<span class="comment">#拼接路径</span></span><br><span class="line">        excels = xlrd.open_workbook(excelPath)</span><br><span class="line">        sheetNames = excels.sheet_names()<span class="comment">#获取目录下所有sheet的名字，sheetNames为list类型</span></span><br><span class="line">        print(<span class="string">&#x27;sheetNames:&#x27;</span>,sheetNames)</span><br><span class="line">        <span class="comment"># 循环从sheetNames中读取sheet表，返回的是sheet的内存地址</span></span><br><span class="line">        <span class="keyword">for</span> sheet <span class="keyword">in</span> sheetNames:</span><br><span class="line">            table = excels.sheet_by_name(sheet)</span><br><span class="line">        print(<span class="string">&#x27;table:&#x27;</span>,table)</span><br><span class="line">        <span class="keyword">return</span> table</span><br><span class="line"><span class="comment">#从getTables()中返回的table中提取数据，sheet中的数据组成一个列表，Excel中的表头和数据分别组成key:value的格式</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getData</span>(<span class="params">sheets</span>):</span></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, sheets.nrows):</span><br><span class="line">        data.append(<span class="built_in">dict</span>(<span class="built_in">zip</span>(sheets.row_values(<span class="number">1</span>), sheets.row_values(i))))</span><br><span class="line">    print(<span class="string">&#x27;读取出的data:&#x27;</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    getData(getTables())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xlsx_to_csv_pd</span>():</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#sheet_name=None 表示读取全部 sheet，或者 sheet_name=[0,10]，此处用 sheet_name，而不是用 sheetname</span></span><br><span class="line">    data_xls = pd.read_excel(<span class="string">r&#x27;D:\jupyter notebook\test\21体侧数据模板.xls&#x27;</span>,sheet_name=<span class="literal">None</span>,index_col=<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> data_xls:</span><br><span class="line">        data_xls[key].to_csv(<span class="string">r&#x27;D:\jupyter notebook\test\key&#x27;</span> +  <span class="string">&#x27;.csv&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                             </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:                        </span><br><span class="line">    xlsx_to_csv_pd()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#模块功能：判断某个文件夹下有几个Excel文件，每个Excel有几个Sheet及Sheet Name</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFileNames</span>(<span class="params">path</span>):</span></span><br><span class="line">    filenames = os.listdir(path)</span><br><span class="line">    <span class="keyword">for</span> i, filename <span class="keyword">in</span> <span class="built_in">enumerate</span>(filenames):</span><br><span class="line">         <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">            iSpecialFile=i+<span class="number">1</span></span><br><span class="line">            sFileName=filename</span><br><span class="line">         print(<span class="string">&#x27;==================第%s个文件=========================&#x27;</span>%(i+<span class="number">1</span>))</span><br><span class="line">         print(<span class="string">&#x27;文件名：%s&#x27;</span>%(filename))</span><br><span class="line">         getSheetNames(path,filename)</span><br><span class="line">    print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;--------------------选择指定的第几个文件-------------------------&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;指定的是第%s个文件:&#x27;</span>%iSpecialFile+sFileName )</span><br><span class="line">    print(<span class="string">&#x27;----------------------------------------------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSheetNames</span>(<span class="params">path,sFileName</span>):</span></span><br><span class="line">    wb = openpyxl.load_workbook(path+<span class="string">&#x27;\\&#x27;</span>+sFileName)</span><br><span class="line">    <span class="comment"># 获取workbook中所有的表格</span></span><br><span class="line">    sheets = wb.sheetnames</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 循环遍历所有sheet</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sheets)):</span><br><span class="line">        sheet = wb[sheets[i]]</span><br><span class="line">        print(<span class="string">&#x27;第&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>) + <span class="string">&#x27;个sheet Name: &#x27;</span> + sheet.title)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    path=<span class="string">r&#x27;D:\jupyter notebook\xx&#x27;</span></span><br><span class="line">    getFileNames(path)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"></span><br><span class="line">students = pd.read_excel(<span class="string">&#x27;./Students.xlsx&#x27;</span>)</span><br><span class="line">students</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">students11 = students.loc[students.Age.apply(<span class="keyword">lambda</span> a:<span class="number">18</span>&lt;=a&lt;=<span class="number">30</span>)].loc[students.Chinese.apply(<span class="keyword">lambda</span> b:b&gt;=<span class="number">90</span>)]</span><br><span class="line">students11</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">score_85</span>(<span class="params">b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> b&gt;=<span class="number">85</span></span><br><span class="line">students = students.loc[students.Chinese.apply(score_85)]</span><br><span class="line">students</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">students22 = students.loc[students.Math.apply(<span class="keyword">lambda</span> b:b&gt;=<span class="number">95</span>)]</span><br><span class="line">students22</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">st = pd.read_excel(<span class="string">&#x27;./stu.xlsx&#x27;</span>)</span><br><span class="line">st</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stu1=st.loc[st.语文.apply(<span class="keyword">lambda</span> x:x&gt;=<span class="number">90</span>)].loc[st.数学.apply(<span class="keyword">lambda</span> y:<span class="number">80</span>&lt;=y&lt;=<span class="number">120</span>)]</span><br><span class="line">stu1</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stu2=st.loc[st.语文.apply(<span class="keyword">lambda</span> x:x&gt;=<span class="number">90</span>)].loc[st.数学.apply(<span class="keyword">lambda</span> y:<span class="number">80</span>&lt;=y&lt;=<span class="number">120</span>)].loc[st.英语.apply(<span class="keyword">lambda</span> z:z&gt;<span class="number">60</span>)]</span><br><span class="line">stu2</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">score_60</span>(<span class="params">c</span>):</span></span><br><span class="line">    <span class="keyword">return</span> c&gt;<span class="number">90</span></span><br><span class="line">stu3=st.loc[st.英语.apply(score_60)]</span><br><span class="line">stu3</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> os </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_excel</span>(<span class="params">path</span>):</span></span><br><span class="line">  df=pd.read_excel(path,<span class="literal">None</span>)</span><br><span class="line">  print(df.keys())</span><br><span class="line">  <span class="comment"># for k,v in df.items():</span></span><br><span class="line">  <span class="comment">#   print(k)</span></span><br><span class="line">  <span class="comment">#   print(v)</span></span><br><span class="line">  <span class="comment">#   print(type(v))</span></span><br><span class="line">  <span class="keyword">return</span> df</span><br><span class="line">path = <span class="string">r&#x27;./stu.xlsx&#x27;</span></span><br><span class="line">read_excel(path)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_excel1</span>(<span class="params">path</span>):</span></span><br><span class="line">  data_xls = pd.ExcelFile(path)</span><br><span class="line">  print(data_xls.sheet_names)</span><br><span class="line">  data=&#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> name <span class="keyword">in</span> data_xls.sheet_names:</span><br><span class="line">    df=data_xls.parse(sheetname=name,header=<span class="literal">None</span>)</span><br><span class="line">    data[name]=df</span><br><span class="line">    <span class="comment"># print(df)</span></span><br><span class="line">    <span class="comment"># print(name)</span></span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line">read_excel1(path)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/07/08/%E4%B8%8D%E5%90%8C%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%B8%AD%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE%E5%90%8E%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%88%B0%E5%90%8C%E5%90%8D%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%96%B0%E8%A1%A8%E4%B8%94%E8%87%AA%E5%8A%A8%E6%89%93%E5%BC%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/07/08/%E4%B8%8D%E5%90%8C%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%B8%AD%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE%E5%90%8E%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%88%B0%E5%90%8C%E5%90%8D%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%96%B0%E8%A1%A8%E4%B8%94%E8%87%AA%E5%8A%A8%E6%89%93%E5%BC%80/" class="post-title-link" itemprop="url">不同工作表中筛选数据后并保存到同名工作表新表且自动打开</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-07-07 16:36:04" itemprop="dateCreated datePublished" datetime="2021-07-07T16:36:04Z">2021-07-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-02 06:46:41" itemprop="dateModified" datetime="2021-08-02T06:46:41Z">2021-08-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取excel 某个sheet下的数据,将其转化为列表数据，方便操作</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_excel_sheet_data</span>(<span class="params">filename, sheetname</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        df = pd.read_excel(filename, sheet_name=sheetname)</span><br><span class="line">        dataList = df.to_dict(orient=<span class="string">&#x27;records&#x27;</span>)  <span class="comment"># 转换为列表</span></span><br><span class="line">        <span class="keyword">return</span> dataList</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&#x27;未能打开此文件，请确认文件名及路径是否正确&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取excel 所有sheet表名，并将其转化为列表返回</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_excel_sheet_list</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        df = pd.read_excel(filename, sheet_name=<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">return</span> df.keys()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    fileName = <span class="string">&#x27;D:/test/xlsx/Notes_111.xlsx&#x27;</span></span><br><span class="line">    sheetList = get_excel_sheet_list(fileName)  <span class="comment"># 获取sheet列表</span></span><br><span class="line">    print(sheetList)</span><br><span class="line">    writer = pd.ExcelWriter(<span class="string">&quot;D:/test/xlsx/新数据.xlsx&quot;</span>, engin=<span class="string">&#x27;openpyxl&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> sheetList:  <span class="comment"># 遍历每个sheet名称</span></span><br><span class="line">        sheetData = get_excel_sheet_data(fileName, i)   <span class="comment"># 读取每个sheet下的数据</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> sheetData:  <span class="comment"># 取出每一项的数据</span></span><br><span class="line">            <span class="comment"># do something</span></span><br><span class="line">            <span class="comment"># 依次根据sheet名称对“新数据.xlsx”此文件多次写入Sheet</span></span><br><span class="line">            pd_look = pd.DataFrame(sheetData)</span><br><span class="line">            pd_look.to_excel(writer, sheet_name=i, index=<span class="literal">False</span>)</span><br><span class="line">        <span class="comment"># 最后保存写入，并释放</span></span><br><span class="line">    writer.save()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 没有操作成功示例</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> time </span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据时间创建工作表名子</span></span><br><span class="line">path = <span class="string">r&quot;D:\test\xlsx&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">    os.mkdir(path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 工作表名字</span></span><br><span class="line">date_rand = time.strftime(<span class="string">&quot;%H-%M-%S&quot;</span>, time.localtime()) <span class="comment"># &quot;%Y-%m-%d&quot; 按日期创建文件</span></span><br><span class="line">out_file_name = path+<span class="string">&#x27;\%s.xlsx&#x27;</span> % date_rand</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取excel 某个sheet下的数据,将其转化为列表数据，方便操作</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_excel_sheet_data</span>(<span class="params">filename, sheetname</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        df = pd.read_excel(filename, sheet_name=sheetname)</span><br><span class="line">        <span class="keyword">return</span> df </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&#x27;未能打开此文件，请确认文件名及路径是否正确&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取excel 所有sheet表名，并将其转化为列表返回</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_excel_sheet_list</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        df = pd.read_excel(filename, sheet_name=<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">return</span> df.keys()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    fileName = <span class="string">&#x27;D:/test/xlsx/Notes_222.xlsx&#x27;</span></span><br><span class="line">    sheetList = get_excel_sheet_list(fileName)  <span class="comment"># 获取sheet列表</span></span><br><span class="line">    print(sheetList)</span><br><span class="line">    writer = pd.ExcelWriter(out_file_name,engine=<span class="string">&#x27;openpyxl&#x27;</span>)</span><br><span class="line">    <span class="comment"># 加上这一句是为了不覆盖掉原xlsx文件里的工作表,要加入 engine=&#x27;openpyxl&#x27; 引擎</span></span><br><span class="line"><span class="comment">#     book = load_workbook(writer.path)</span></span><br><span class="line">    <span class="comment"># 加上这一句是为了不覆盖掉原xlsx文件里的工作表，同时也 import 入 from openpylx import load_workbook</span></span><br><span class="line"><span class="comment">#     writer.book = book</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> sheetList:  <span class="comment"># 遍历每个sheet名称</span></span><br><span class="line">        sheetData = get_excel_sheet_data(fileName, i)   <span class="comment"># 读取每个sheet下的数据</span></span><br><span class="line">        df=sheetData[sheetData[<span class="string">&#x27;code&#x27;</span>]==<span class="number">111</span>] <span class="comment"># do something</span></span><br><span class="line">        print(df)</span><br><span class="line">        <span class="comment"># 依次根据sheet名称对“新数据.xlsx”此文件多次写入Sheet</span></span><br><span class="line">        df.to_excel(writer, sheet_name=i, index=<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">    writer.save()  <span class="comment"># 最后保存写入，并释放</span></span><br><span class="line">    os.startfile(path)  <span class="comment"># 推荐此种写法</span></span><br><span class="line">    <span class="comment"># os.system(&#x27;explorer.exe &#x27; + path) # 程序执行完后自动打开目标文件夹 </span></span><br></pre></td></tr></table></figure>
<pre><code>dict_keys([&#39;Sheet1&#39;])
   code       city
0   111         NY
1   111         CA
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sPath=<span class="string">r&#x27;d:\test1&#x27;</span></span><br><span class="line">os.startfile(sPath)</span><br><span class="line"><span class="comment"># os.system(&#x27;explorer.exe &#x27; + sPath)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    print(time.localtime())</span><br><span class="line"></span><br><span class="line">    year = time.localtime().tm_year</span><br><span class="line">    month = time.localtime().tm_mon</span><br><span class="line">    day = time.localtime().tm_mday</span><br><span class="line"></span><br><span class="line">    hour = time.localtime().tm_hour</span><br><span class="line">    minute = time.localtime().tm_min</span><br><span class="line">    second = time.localtime().tm_sec</span><br><span class="line"></span><br><span class="line">    print(year, <span class="string">&#x27;年&#x27;</span>, month, <span class="string">&#x27;月&#x27;</span>, day, <span class="string">&#x27;日&#x27;</span>)</span><br><span class="line">    print(hour, <span class="string">&#x27;时&#x27;</span>, minute, <span class="string">&#x27;分&#x27;</span>, second, <span class="string">&#x27;秒&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>time.struct_time(tm_year=2021, tm_mon=7, tm_mday=7, tm_hour=16, tm_min=30, tm_sec=37, tm_wday=2, tm_yday=188, tm_isdst=0)
2021 年 7 月 7 日
16 时 30 分 37 秒
</code></pre>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://getcoden.github.io/2021/07/06/%E5%A4%9A%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%BF%9D%E5%AD%98%E8%87%B3%E4%B8%80%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%96%84%E5%86%85%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Bitcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bitcoder">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/07/06/%E5%A4%9A%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%BF%9D%E5%AD%98%E8%87%B3%E4%B8%80%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%96%84%E5%86%85%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">多工作表保存至一个工作薄内问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-07-06 10:47:56" itemprop="dateCreated datePublished" datetime="2021-07-06T10:47:56Z">2021-07-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-07 09:20:36" itemprop="dateModified" datetime="2021-07-07T09:20:36Z">2021-07-07</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93%E4%B9%8BPandas/" itemprop="url" rel="index"><span itemprop="name">Python库之Pandas</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="pandas-将多个-dataframe-以多个-sheet-的形式保存到一个-excel-文件中"><a href="#pandas-将多个-dataframe-以多个-sheet-的形式保存到一个-excel-文件中" class="headerlink" title="pandas 将多个 dataframe 以多个 sheet 的形式保存到一个 excel 文件中"></a>pandas 将多个 dataframe 以多个 sheet 的形式保存到一个 excel 文件中</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">writer &#x3D; pd.ExcelWriter(&#39;test.xlsx&#39;)</span><br><span class="line">data1.to_excel(writer,sheet_name&#x3D;&#39;sheet1&#39;)</span><br><span class="line">data2.to_excel(writer,sheet_name&#x3D;&#39;sheet2&#39;)</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure>
<h3 id="上面的方法会将原来的-excel-文件覆盖掉，假如想要对已经存在的-excel-文件进行修改，可以使用开源工具包（anaconda-已附带）openpyxl"><a href="#上面的方法会将原来的-excel-文件覆盖掉，假如想要对已经存在的-excel-文件进行修改，可以使用开源工具包（anaconda-已附带）openpyxl" class="headerlink" title="上面的方法会将原来的 excel 文件覆盖掉，假如想要对已经存在的 excel 文件进行修改，可以使用开源工具包（anaconda 已附带）openpyxl"></a>上面的方法会将原来的 excel 文件覆盖掉，假如想要对已经存在的 excel 文件进行修改，可以使用开源工具包（anaconda 已附带）openpyxl</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from openpyxl import load_workbook  # 这一句必须写</span><br><span class="line"> </span><br><span class="line">writer &#x3D; pd.ExcelWriter(&#39;test.xlsx&#39;,engin&#x3D;&#39;openpyxl&#39;)</span><br><span class="line">book &#x3D; load_workbook(writer.path)</span><br><span class="line">writer.book &#x3D; book</span><br><span class="line">dataframe.to_excel(excel_writer&#x3D;writer,sheet_name&#x3D;&quot;info5&quot;)</span><br><span class="line">writer.save()</span><br><span class="line">writer.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="另一种高效的写法"><a href="#另一种高效的写法" class="headerlink" title="另一种高效的写法"></a>另一种高效的写法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">with pd.ExcelWriter(r&quot;D:\test1\result.xlsx&quot;, engine&#x3D;&#39;openpyxl&#39;) as writer:  # 这是一种高效的写法 from openpyxl import load_workbook 这一句必须写</span><br><span class="line">    book &#x3D; load_workbook(writer.path)</span><br><span class="line">    writer.book &#x3D; book</span><br><span class="line">    data1.to_excel(writer,sheet_name&#x3D;&#39;sheet1&#39;)</span><br><span class="line">    data2.to_excel(writer,sheet_name&#x3D;&#39;sheet2&#39;)</span><br></pre></td></tr></table></figure>
<p>示例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import os</span><br><span class="line">from openpyxl import load_workbook  # 必须导入的模块</span><br><span class="line"></span><br><span class="line">path &#x3D; r&quot;D:\test1\file_folder&quot;</span><br><span class="line">listing &#x3D; os.listdir(path)</span><br><span class="line">data_list &#x3D; [f for f in listing if f[-5:] &#x3D;&#x3D; &#39;.xlsx&#39;]  # 为了排除不是.xlsx的文件，避免程序报错</span><br><span class="line"></span><br><span class="line">with pd.ExcelWriter(r&quot;D:\test1\result.xlsx&quot;, engine&#x3D;&#39;openpyxl&#39;) as writer:  # 这是一种高效的写法</span><br><span class="line">    for i in data_list:</span><br><span class="line">        name &#x3D; i.split(&#39;.&#39;)[0]</span><br><span class="line">        df1 &#x3D; pd.read_excel(os.path.join(path, i))</span><br><span class="line">        df1.to_excel(writer, sheet_name&#x3D;name, index&#x3D;False)  # 程序的逻辑</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="获取工作薄所有工作表列表"><a href="#获取工作薄所有工作表列表" class="headerlink" title="获取工作薄所有工作表列表"></a>获取工作薄所有工作表列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">方法一</span><br><span class="line"></span><br><span class="line">df &#x3D; pd.read_excel(path, sheet_name&#x3D;None)</span><br><span class="line">for i in df.keys():</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">方法二:</span><br><span class="line"></span><br><span class="line">df &#x3D; pd.read_excel(path, sheet_name&#x3D;None)</span><br><span class="line">sheet_name_list &#x3D; list(df)</span><br><span class="line">print(sheet_name_list)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 另一种写法</span><br><span class="line"></span><br><span class="line">writer &#x3D; pd.ExcelWriter(r&#39;result.xlsx&#39;)</span><br><span class="line"></span><br><span class="line">for i in os.listdir(r&#39;.&#x2F;file_folder&#39;):</span><br><span class="line">    name &#x3D; i.split(&#39;.&#39;)[0]</span><br><span class="line">    df1 &#x3D; pd.read_excel(os.path.join(r&#39;.&#x2F;file_folder&#39;, i))</span><br><span class="line">    df1.to_excel(writer, sheet_name&#x3D;name, index&#x3D;False)</span><br><span class="line">writer.save()  # 这2个操作不能忘记，否则文件只在缓存里，看不到直接的操作结果</span><br><span class="line">writer.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Python-pandas-如何向-excel-添加数据"><a href="#Python-pandas-如何向-excel-添加数据" class="headerlink" title="Python pandas 如何向 excel 添加数据"></a>Python pandas 如何向 excel 添加数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 创建一个空的excel文件</span><br><span class="line">nan_excle &#x3D; pd.DataFrame()</span><br><span class="line">nan_excel.to_excel(path + filename)</span><br><span class="line"></span><br><span class="line"># 打开excel</span><br><span class="line">writer &#x3D; pd.ExcelWriter(path + filename)</span><br><span class="line">#sheets是要写入的excel工作簿名称列表</span><br><span class="line">for sheet in sheets:</span><br><span class="line">　　output.to_excel(writer, sheet_name&#x3D;sheet)</span><br><span class="line"></span><br><span class="line"># 保存writer中的数据至excel</span><br><span class="line"># 如果省略该语句，则数据不会写入到上边创建的excel文件中</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure>
<h2 id="不同方法读取-excel-中的多个不同-sheet-表格性能比较"><a href="#不同方法读取-excel-中的多个不同-sheet-表格性能比较" class="headerlink" title="不同方法读取 excel 中的多个不同 sheet 表格性能比较"></a>不同方法读取 excel 中的多个不同 sheet 表格性能比较</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># 方法1</span><br><span class="line">def read_excel(path):</span><br><span class="line">  df&#x3D;pd.read_excel(path,None)</span><br><span class="line">  print(df.keys())</span><br><span class="line">  # for k,v in df.items():</span><br><span class="line">  #   print(k)</span><br><span class="line">  #   print(v)</span><br><span class="line">  #   print(type(v))</span><br><span class="line">  return df</span><br><span class="line"> </span><br><span class="line"># 方法2</span><br><span class="line">def read_excel1(path):</span><br><span class="line">  data_xls &#x3D; pd.ExcelFile(path)</span><br><span class="line">  print(data_xls.sheet_names)</span><br><span class="line">  data&#x3D;&#123;&#125;</span><br><span class="line">  for name in data_xls.sheet_names:</span><br><span class="line">    df&#x3D;data_xls.parse(sheetname&#x3D;name,header&#x3D;None)</span><br><span class="line">    data[name]&#x3D;df</span><br><span class="line">    # print(df)</span><br><span class="line">    # print(name)</span><br><span class="line">  return data</span><br><span class="line"> </span><br><span class="line"># 方法3</span><br><span class="line">def read_excel2(path):</span><br><span class="line">  data_xls &#x3D; pd.io.excel.ExcelFile(path)</span><br><span class="line">  data&#x3D;&#123;&#125;</span><br><span class="line">  print(data_xls.sheet_names)</span><br><span class="line">  for name in data_xls.sheet_names:</span><br><span class="line">    df&#x3D;pd.read_excel(data_xls,sheetname&#x3D;name,header&#x3D;None)</span><br><span class="line">    data[name]&#x3D;df</span><br><span class="line">  return data</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<h3 id="结论：若读取多个-sheet-表格时，方法-2-和方法-3-相对于方法-1-的效率较高。"><a href="#结论：若读取多个-sheet-表格时，方法-2-和方法-3-相对于方法-1-的效率较高。" class="headerlink" title="结论：若读取多个 sheet 表格时，方法 2 和方法 3 相对于方法 1 的效率较高。"></a>结论：若读取多个 sheet 表格时，方法 2 和方法 3 相对于方法 1 的效率较高。</h3><p>一、简介</p>
<p>　　pandas 中的 ExcelFile () 和 ExcelWriter ()，是 pandas 中对 excel 表格文件进行读写相关操作非常方便快捷的类，尤其是在对含有多个 sheet 的 excel 文件进行操控时非常方便，本文就将针对这两个类的使用方法展开介绍；</p>
<p>二、ExcelFile ()</p>
<p>　　在使用 ExcelFile () 时需要传入目标 excel 文件所在路径及文件名称，下面是示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">demo_excel &#x3D; pd.ExcelFile(r&#39;D:\demo.xlsx&#39;)</span><br></pre></td></tr></table></figure>
<p>接下来可以使用 ExcelFile () 中的方法来获取目标表格文件的相关信息：</p>
<p>1、sheet_names</p>
<p>使用 sheet_names 来查看当前表格中包含的所有 sheet 名称（按顺序）：</p>
<p><code>print(demo_excel.sheet_names)</code></p>
<p>　2、parse()</p>
<p>　　使用 parse () 可以根据传入的 sheet 名称来提取对应的表格信息，下面是一个简单的示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">table1 &#x3D; demo_excel.parse(sheet_name&#x3D;demo_excel.sheet_names[0])</span><br><span class="line"></span><br><span class="line">table2 &#x3D; demo_excel.parse(sheet_name&#x3D;demo_excel.sheet_names[1])</span><br><span class="line"></span><br><span class="line">table3 &#x3D; demo_excel.parse(sheet_name&#x3D;demo_excel.sheet_names[2])</span><br><span class="line"></span><br><span class="line">print(table1)</span><br><span class="line">print(table2)</span><br><span class="line">print(table3)</span><br></pre></td></tr></table></figure>
<p>基于已创建的 writer 对象，可以利用 to_excel () 方法将不同的数据框及其对应的 sheet 名称写入该 writer 对象中，并在全部表格写入完成之后，使用 save () 方法来执行 writer 中内容向对应实体 excel 文件写入数据的过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;&#39;创建数据框1&#39;&#39;&#39;</span><br><span class="line">df1 &#x3D; pd.DataFrame(&#123;&#39;V1&#39;:np.random.rand(100),</span><br><span class="line">          &#39;V2 &#39;:np.random.rand(100),</span><br><span class="line">          &#39;V3&#39;:np.random.rand(100)&#125;)</span><br><span class="line">df1.to_excel(writer,sheet_name&#x3D;&#39;sheet1&#39;,index&#x3D;False)</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;创建数据框2&#39;&#39;&#39;</span><br><span class="line">df2 &#x3D; pd.DataFrame(&#123;&#39;V1&#39;:np.random.rand(100),</span><br><span class="line">          &#39;V2 &#39;:np.random.rand(100),</span><br><span class="line">          &#39;V3&#39;:np.random.rand(100)&#125;)</span><br><span class="line">df2.to_excel(writer,sheet_name&#x3D;&#39;sheet2&#39;,index&#x3D;False)</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;创建数据框3&#39;&#39;&#39;</span><br><span class="line">df3 &#x3D; pd.DataFrame(&#123;&#39;V1&#39;:np.random.rand(100),</span><br><span class="line">          &#39;V2 &#39;:np.random.rand(100),</span><br><span class="line">          &#39;V3&#39;:np.random.rand(100)&#125;)</span><br><span class="line">df3.to_excel(writer,sheet_name&#x3D;&#39;sheet3&#39;,index&#x3D;False)</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;数据写出到excel文件中&#39;&#39;&#39;</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bitcode</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  





</body>
</html>
